___
Теги: #plan
Дата создания: 2023-09-04 12:05 
Последнее изменение: понедельник 4-го сентября 2023 12:05:16
<< [[2023-09-03]] | [[2023-09-05]] >> 
___
## 1. Сеть

1. Доступ к тачке по SSH
	1. Ограничить доступ по ключам
	2. Отключить рут пользователя при подключении по SHH
2. Доступ к тачке по портам
	1. Необходимо поставить только нужные порты 
	2. Необходимо предварительно просканить тачку на открытые порты при помощи ***nmap***
	3. Ограничить доступ при помощи **ipatables**
3. Доступ к тачке из подсетей
	1. Необходимо ограничить доступ к тачке и сделать его доступным только из подсети **YSTS** и **YSTS-VPN**

---
## 2. ОС

1. Выдать sudoers права пользователю **administrator** 
2. Ограничить права остальным пользователям в системе (postgres/apache и тд)
3. Ограничить доступ к приложениям и ресурсам ВМ при помощи **AppArmor** 
---
## 3. Скрипт

```sh
#!/bin/bash
# Используется для обеспечения безопасности linux машины

## Запрет любых протоколов подключений

sudo touch /etc/hosts.deny
cat > /etc/hosts.deny << EOF
ALL : ALL
EOF

## Разрешение ssh, icmp только внутренней сети

sudo touch /etc/hosts.allow
cat > /etc/hosts.allow << EOF
sshd : 10.0.5.0/24,10.20.20.0/24,10.10.10.1,192.168.111.0/24,172.16.96.0/20,172.16.104.0/24,172.16.105.0/24,172.16.106.0/24,172.16.107.0/24,172.16.109.0/24
icmp : 10.0.5.0/24,10.20.20.0/24,10.10.10.1,192.168.111.0/24,172.16.96.0/20,172.16.104.0/24,172.16.105.0/24,172.16.106.0/24,172.16.107.0/24,172.16.109.0/24
EOF

## В ssh конфиге изменяется порт ssh на 44444 и отключается удаленный root-доступ

cat >> /etc/ssh/sshd_config << EOF
Include /etc/ssh/sshd_config.d/*.conf
# Изменяем стандартный порт ssh подключения
Port 44444

# Выключаем root-подключение
PermitRootLogin no

# Выключаем авторизацию через пароль
PasswordAuthentication no

# Включаем авторизацию по публичному ключу
PubkeyAuthentication yes
EOF

## Перезагрузка сервисов ssh и firewall

sudo systemctl restart sshd

```

--

### Zero-Links
- [[00 Linux]]
- [[00 Безопасность]]
### Links
- [[Безопасность контейнеров в Linux]]
- [[Безопасность контейнеров]]
